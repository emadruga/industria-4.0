{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://industria40.gov.br/schemas/question-schema.json",
  "title": "Industry 4.0 Maturity Model Question Schema",
  "description": "Schema for maturity assessment questions based on ACATECH and SIRI frameworks",
  "version": "1.0.0",

  "definitions": {
    "maturity_level": {
      "type": "object",
      "required": ["level", "label", "description"],
      "properties": {
        "level": {
          "type": "integer",
          "minimum": 0,
          "maximum": 6,
          "description": "Maturity level number (0-6)"
        },
        "label": {
          "type": "string",
          "minLength": 1,
          "description": "Short label for the maturity level"
        },
        "description": {
          "type": "string",
          "minLength": 1,
          "description": "Detailed description of what this maturity level represents"
        }
      }
    },

    "evidence_sources": {
      "type": "object",
      "properties": {
        "artifacts": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "List of artifacts and documents that can serve as evidence"
        },
        "metrics": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "List of measurable KPIs and metrics"
        },
        "signals_by_level": {
          "type": "object",
          "patternProperties": {
            "^N[0-6]$": {
              "type": "string"
            }
          },
          "description": "Observable signals and indicators for each maturity level"
        },
        "sampling_guidance": {
          "type": "string",
          "description": "Guidance on how to collect and sample evidence"
        }
      }
    },

    "question": {
      "type": "object",
      "required": ["id", "question_number", "title", "text", "maturity_levels"],
      "properties": {
        "id": {
          "type": "string",
          "pattern": "^Q-[A-Z]+-[A-Z]+-[A-Z]+-[A-Z]+-[0-9]{3}$",
          "description": "Unique question identifier (e.g., Q-ORG-EG-CL-GA-001)"
        },
        "question_number": {
          "type": "integer",
          "minimum": 1,
          "description": "Sequential number of the question within the capacity"
        },
        "title": {
          "type": "string",
          "minLength": 1,
          "description": "Short title of the question"
        },
        "text": {
          "type": "string",
          "minLength": 1,
          "description": "Full text of the assessment question"
        },
        "maturity_levels": {
          "type": "array",
          "minItems": 1,
          "maxItems": 7,
          "items": {
            "$ref": "#/definitions/maturity_level"
          },
          "description": "Array of maturity level definitions (0-6)"
        },
        "evidence_sources": {
          "$ref": "#/definitions/evidence_sources",
          "description": "Sources of evidence for assessing this question"
        },
        "notes": {
          "type": "string",
          "description": "Additional notes or clarifications"
        }
      }
    },

    "metadata": {
      "type": "object",
      "required": ["source_frameworks", "author", "version", "last_updated"],
      "properties": {
        "source_frameworks": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["ACATECH", "SIRI", "CUSTOM"]
          },
          "minItems": 1,
          "description": "Source frameworks this capacity is based on"
        },
        "author": {
          "type": "string",
          "minLength": 1,
          "description": "Primary author who developed this capacity"
        },
        "co_authors": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Additional authors who contributed"
        },
        "version": {
          "type": "string",
          "pattern": "^[0-9]+\\.[0-9]+$",
          "description": "Version number (e.g., 1.0, 2.1)"
        },
        "last_updated": {
          "type": "string",
          "format": "date",
          "description": "Last update date in YYYY-MM-DD format"
        },
        "source_docx": {
          "type": "string",
          "description": "Original DOCX filename"
        },
        "status": {
          "type": "string",
          "enum": ["draft", "review", "approved", "deprecated"],
          "default": "draft",
          "description": "Current status of this capacity"
        }
      }
    },

    "capacity": {
      "type": "object",
      "required": ["id", "name", "block", "pilar", "dimension", "description"],
      "properties": {
        "id": {
          "type": "string",
          "pattern": "^CAP-[A-Z]+-[A-Z]+-[A-Z]+-[0-9]{3}$",
          "description": "Unique capacity identifier (e.g., CAP-ORG-EG-CL-001)"
        },
        "name": {
          "type": "string",
          "minLength": 1,
          "description": "Name of the capacity"
        },
        "block": {
          "type": "string",
          "enum": ["Organização", "Processo", "Tecnologia"],
          "description": "Top-level block in the hierarchy"
        },
        "pilar": {
          "type": "string",
          "minLength": 1,
          "description": "Pilar within the block"
        },
        "dimension": {
          "type": "string",
          "minLength": 1,
          "description": "Dimension within the pilar"
        },
        "description": {
          "type": "string",
          "minLength": 1,
          "description": "Detailed description of the capacity"
        },
        "related_capacities": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "List of related capacity names"
        },
        "metadata": {
          "$ref": "#/definitions/metadata"
        }
      }
    }
  },

  "type": "object",
  "required": ["capacity", "questions"],
  "properties": {
    "capacity": {
      "$ref": "#/definitions/capacity"
    },
    "questions": {
      "type": "array",
      "minItems": 1,
      "items": {
        "$ref": "#/definitions/question"
      }
    },
    "glossary": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["term", "definition"],
        "properties": {
          "term": {
            "type": "string",
            "minLength": 1
          },
          "definition": {
            "type": "string",
            "minLength": 1
          }
        }
      },
      "description": "Glossary of terms used in this capacity"
    },
    "references": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["citation"],
        "properties": {
          "citation": {
            "type": "string",
            "minLength": 1
          },
          "url": {
            "type": "string",
            "format": "uri"
          },
          "type": {
            "type": "string",
            "enum": ["book", "article", "report", "standard", "web"]
          }
        }
      },
      "description": "Academic and professional references"
    }
  }
}
